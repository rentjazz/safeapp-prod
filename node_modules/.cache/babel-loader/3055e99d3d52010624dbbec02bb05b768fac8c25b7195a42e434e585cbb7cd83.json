{"ast":null,"code":"import _objectSpread from\"/data/.openclaw/workspace/safeapp-prod/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import ApiService from'../services/api';import{CheckCircle,Circle,Plus,Trash2,Calendar}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Tasks(){const[tasks,setTasks]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[newTask,setNewTask]=useState('');const[listId,setListId]=useState('@default');useEffect(()=>{loadTasks();},[]);const loadTasks=async()=>{try{setLoading(true);console.log('Loading tasks...');const data=await ApiService.getTasks();console.log('Tasks data received:',JSON.stringify(data).substring(0,200));// Google Tasks API returns items in data\nconst items=data.items||[];console.log('Items count:',items.length);setTasks(items.sort((a,b)=>{// Non complétés d'abord\nif(a.status==='completed'&&b.status!=='completed')return 1;if(a.status!=='completed'&&b.status==='completed')return-1;return 0;}));setError(null);}catch(err){console.error('Error loading tasks:',err);setError(err.message||'Erreur inconnue');}finally{setLoading(false);}};const toggleTask=async task=>{try{const updated=_objectSpread(_objectSpread({},task),{},{status:task.status==='completed'?'needsAction':'completed'});await ApiService.updateTask(listId,task.id,updated);loadTasks();}catch(err){alert('Erreur: '+err.message);}};const deleteTask=async taskId=>{if(!window.confirm('Supprimer cette tâche ?'))return;try{await ApiService.deleteTask(listId,taskId);loadTasks();}catch(err){alert('Erreur: '+err.message);}};const addTask=async e=>{e.preventDefault();if(!newTask.trim())return;try{await ApiService.createTask({listId,title:newTask});setNewTask('');loadTasks();}catch(err){alert('Erreur: '+err.message);}};const formatDate=dateStr=>{if(!dateStr)return'';return new Date(dateStr).toLocaleDateString('fr-FR');};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Chargement...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[\"Erreur: \",error]});return/*#__PURE__*/_jsxs(\"div\",{className:\"tasks-container\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:addTask,className:\"add-task-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newTask,onChange:e=>setNewTask(e.target.value),placeholder:\"Nouvelle t\\xE2che...\",className:\"task-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",children:/*#__PURE__*/_jsx(Plus,{size:20})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"task-list\",children:tasks.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"empty\",children:\"Aucune t\\xE2che\"}):tasks.map(task=>/*#__PURE__*/_jsxs(\"div\",{className:\"task-item \".concat(task.status==='completed'?'completed':''),children:[/*#__PURE__*/_jsx(\"button\",{className:\"task-toggle\",onClick:()=>toggleTask(task),children:task.status==='completed'?/*#__PURE__*/_jsx(CheckCircle,{size:22}):/*#__PURE__*/_jsx(Circle,{size:22})}),/*#__PURE__*/_jsxs(\"div\",{className:\"task-content\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"task-title\",children:task.title}),task.due&&/*#__PURE__*/_jsxs(\"span\",{className:\"task-date\",children:[/*#__PURE__*/_jsx(Calendar,{size:14}),\" \",formatDate(task.due)]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"task-delete\",onClick:()=>deleteTask(task.id),children:/*#__PURE__*/_jsx(Trash2,{size:18})})]},task.id))})]});}export default Tasks;","map":{"version":3,"names":["React","useState","useEffect","ApiService","CheckCircle","Circle","Plus","Trash2","Calendar","jsx","_jsx","jsxs","_jsxs","Tasks","tasks","setTasks","loading","setLoading","error","setError","newTask","setNewTask","listId","setListId","loadTasks","console","log","data","getTasks","JSON","stringify","substring","items","length","sort","a","b","status","err","message","toggleTask","task","updated","_objectSpread","updateTask","id","alert","deleteTask","taskId","window","confirm","addTask","e","preventDefault","trim","createTask","title","formatDate","dateStr","Date","toLocaleDateString","className","children","onSubmit","type","value","onChange","target","placeholder","size","map","concat","onClick","due"],"sources":["/data/.openclaw/workspace/safeapp-prod/src/components/Tasks.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport ApiService from '../services/api';\nimport { CheckCircle, Circle, Plus, Trash2, Calendar } from 'lucide-react';\n\nfunction Tasks() {\n  const [tasks, setTasks] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [newTask, setNewTask] = useState('');\n  const [listId, setListId] = useState('@default');\n\n  useEffect(() => {\n    loadTasks();\n  }, []);\n\n  const loadTasks = async () => {\n    try {\n      setLoading(true);\n      console.log('Loading tasks...');\n      const data = await ApiService.getTasks();\n      console.log('Tasks data received:', JSON.stringify(data).substring(0, 200));\n      // Google Tasks API returns items in data\n      const items = data.items || [];\n      console.log('Items count:', items.length);\n      setTasks(items.sort((a, b) => {\n        // Non complétés d'abord\n        if (a.status === 'completed' && b.status !== 'completed') return 1;\n        if (a.status !== 'completed' && b.status === 'completed') return -1;\n        return 0;\n      }));\n      setError(null);\n    } catch (err) {\n      console.error('Error loading tasks:', err);\n      setError(err.message || 'Erreur inconnue');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const toggleTask = async (task) => {\n    try {\n      const updated = {\n        ...task,\n        status: task.status === 'completed' ? 'needsAction' : 'completed'\n      };\n      await ApiService.updateTask(listId, task.id, updated);\n      loadTasks();\n    } catch (err) {\n      alert('Erreur: ' + err.message);\n    }\n  };\n\n  const deleteTask = async (taskId) => {\n    if (!window.confirm('Supprimer cette tâche ?')) return;\n    try {\n      await ApiService.deleteTask(listId, taskId);\n      loadTasks();\n    } catch (err) {\n      alert('Erreur: ' + err.message);\n    }\n  };\n\n  const addTask = async (e) => {\n    e.preventDefault();\n    if (!newTask.trim()) return;\n    try {\n      await ApiService.createTask({\n        listId,\n        title: newTask\n      });\n      setNewTask('');\n      loadTasks();\n    } catch (err) {\n      alert('Erreur: ' + err.message);\n    }\n  };\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return '';\n    return new Date(dateStr).toLocaleDateString('fr-FR');\n  };\n\n  if (loading) return <div className=\"loading\">Chargement...</div>;\n  if (error) return <div className=\"error\">Erreur: {error}</div>;\n\n  return (\n    <div className=\"tasks-container\">\n      <form onSubmit={addTask} className=\"add-task-form\">\n        <input\n          type=\"text\"\n          value={newTask}\n          onChange={(e) => setNewTask(e.target.value)}\n          placeholder=\"Nouvelle tâche...\"\n          className=\"task-input\"\n        />\n        <button type=\"submit\" className=\"btn-primary\">\n          <Plus size={20} />\n        </button>\n      </form>\n\n      <div className=\"task-list\">\n        {tasks.length === 0 ? (\n          <p className=\"empty\">Aucune tâche</p>\n        ) : (\n          tasks.map(task => (\n            <div key={task.id} className={`task-item ${task.status === 'completed' ? 'completed' : ''}`}>\n              <button \n                className=\"task-toggle\"\n                onClick={() => toggleTask(task)}\n              >\n                {task.status === 'completed' ? <CheckCircle size={22} /> : <Circle size={22} />}\n              </button>\n              <div className=\"task-content\">\n                <span className=\"task-title\">{task.title}</span>\n                {task.due && (\n                  <span className=\"task-date\">\n                    <Calendar size={14} /> {formatDate(task.due)}\n                  </span>\n                )}\n              </div>\n              <button \n                className=\"task-delete\"\n                onClick={() => deleteTask(task.id)}\n              >\n                <Trash2 size={18} />\n              </button>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Tasks;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}