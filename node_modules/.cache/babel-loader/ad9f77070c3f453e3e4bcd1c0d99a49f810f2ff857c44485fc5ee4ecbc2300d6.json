{"ast":null,"code":"import React,{useState,useEffect}from'react';import ApiService from'../services/api';import{Package,AlertTriangle}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Stock(){const[items,setItems]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{loadStock();},[]);const loadStock=async()=>{try{setLoading(true);const data=await ApiService.getStock();// Google Sheets returns array of arrays\nconst rows=data||[];const headers=rows[0]||['Référence','Nom','Qté','Min','Emplacement','Fournisseur'];const items=rows.slice(1).map((row,index)=>({id:index,reference:row[0]||'',name:row[1]||'',quantity:parseInt(row[2])||0,minQuantity:parseInt(row[3])||0,location:row[4]||'',supplier:row[5]||''}));setItems(items);setError(null);}catch(err){setError(err.message);}finally{setLoading(false);}};const lowStock=items.filter(item=>item.quantity<=item.minQuantity&&item.minQuantity>0);if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Chargement...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[\"Erreur: \",error]});return/*#__PURE__*/_jsxs(\"div\",{className:\"stock-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stock-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(Package,{size:32}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:items.length}),/*#__PURE__*/_jsx(\"p\",{children:\"Articles\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card warning\",children:[/*#__PURE__*/_jsx(AlertTriangle,{size:32}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:lowStock.length}),/*#__PURE__*/_jsx(\"p\",{children:\"Stock faible\"})]})]})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"stock-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"R\\xE9f\\xE9rence\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Nom\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Qt\\xE9\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Min\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Emplacement\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:items.map(item=>/*#__PURE__*/_jsxs(\"tr\",{className:item.quantity<=item.minQuantity?'low-stock':'',children:[/*#__PURE__*/_jsx(\"td\",{children:item.reference}),/*#__PURE__*/_jsx(\"td\",{children:item.name}),/*#__PURE__*/_jsx(\"td\",{className:item.quantity<=item.minQuantity?'warning':'',children:item.quantity}),/*#__PURE__*/_jsx(\"td\",{children:item.minQuantity}),/*#__PURE__*/_jsx(\"td\",{children:item.location})]},item.id))})]})]});}export default Stock;","map":{"version":3,"names":["React","useState","useEffect","ApiService","Package","AlertTriangle","jsx","_jsx","jsxs","_jsxs","Stock","items","setItems","loading","setLoading","error","setError","loadStock","data","getStock","rows","headers","slice","map","row","index","id","reference","name","quantity","parseInt","minQuantity","location","supplier","err","message","lowStock","filter","item","className","children","size","length"],"sources":["/data/.openclaw/workspace/safeapp-prod/src/components/Stock.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport ApiService from '../services/api';\nimport { Package, AlertTriangle } from 'lucide-react';\n\nfunction Stock() {\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    loadStock();\n  }, []);\n\n  const loadStock = async () => {\n    try {\n      setLoading(true);\n      const data = await ApiService.getStock();\n      // Google Sheets returns array of arrays\n      const rows = data || [];\n      const headers = rows[0] || ['Référence', 'Nom', 'Qté', 'Min', 'Emplacement', 'Fournisseur'];\n      const items = rows.slice(1).map((row, index) => ({\n        id: index,\n        reference: row[0] || '',\n        name: row[1] || '',\n        quantity: parseInt(row[2]) || 0,\n        minQuantity: parseInt(row[3]) || 0,\n        location: row[4] || '',\n        supplier: row[5] || ''\n      }));\n      setItems(items);\n      setError(null);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const lowStock = items.filter(item => item.quantity <= item.minQuantity && item.minQuantity > 0);\n\n  if (loading) return <div className=\"loading\">Chargement...</div>;\n  if (error) return <div className=\"error\">Erreur: {error}</div>;\n\n  return (\n    <div className=\"stock-container\">\n      <div className=\"stock-stats\">\n        <div className=\"stat-card\">\n          <Package size={32} />\n          <div>\n            <h3>{items.length}</h3>\n            <p>Articles</p>\n          </div>\n        </div>\n        <div className=\"stat-card warning\">\n          <AlertTriangle size={32} />\n          <div>\n            <h3>{lowStock.length}</h3>\n            <p>Stock faible</p>\n          </div>\n        </div>\n      </div>\n\n      <table className=\"stock-table\">\n        <thead>\n          <tr>\n            <th>Référence</th>\n            <th>Nom</th>\n            <th>Qté</th>\n            <th>Min</th>\n            <th>Emplacement</th>\n          </tr>\n        </thead>\n        <tbody>\n          {items.map(item => (\n            <tr key={item.id} className={item.quantity <= item.minQuantity ? 'low-stock' : ''}>\n              <td>{item.reference}</td>\n              <td>{item.name}</td>\n              <td className={item.quantity <= item.minQuantity ? 'warning' : ''}>\n                {item.quantity}\n              </td>\n              <td>{item.minQuantity}</td>\n              <td>{item.location}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n\nexport default Stock;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}